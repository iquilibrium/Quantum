#!/usr/bin/env python3
"""Script para corrigir IDs duplicados no SQL"""

with open('populate_course_data.sql', 'r') as f:
    content = f.read()

# Substituir IDs das opções para serem únicos
# Formato: opt_QUIZ_OPCAO (ex: opt_1_1_1 para quiz q_1_1, opção 1)

replacements = [
    # Quiz 1.1
    ("('opt_1', 'q_1_1'", "('opt_1_1_1', 'q_1_1'"),
    ("('opt_2', 'q_1_1'", "('opt_1_1_2', 'q_1_1'"),
    ("('opt_3', 'q_1_1'", "('opt_1_1_3', 'q_1_1'"),
    ("('opt_4', 'q_1_1'", "('opt_1_1_4', 'q_1_1'"),
    
    # Quiz 1.2
    ("('opt_1', 'q_1_2'", "('opt_1_2_1', 'q_1_2'"),
    ("('opt_2', 'q_1_2'", "('opt_1_2_2', 'q_1_2'"),
    ("('opt_3', 'q_1_2'", "('opt_1_2_3', 'q_1_2'"),
    ("('opt_4', 'q_1_2'", "('opt_1_2_4', 'q_1_2'"),
    
    # Quiz 1.3
    ("('opt_1', 'q_1_3'", "('opt_1_3_1', 'q_1_3'"),
    ("('opt_2', 'q_1_3'", "('opt_1_3_2', 'q_1_3'"),
    ("('opt_3', 'q_1_3'", "('opt_1_3_3', 'q_1_3'"),
    ("('opt_4', 'q_1_3'", "('opt_1_3_4', 'q_1_3'"),
    
    # Quiz 1.4
    ("('opt_1', 'q_1_4'", "('opt_1_4_1', 'q_1_4'"),
    ("('opt_2', 'q_1_4'", "('opt_1_4_2', 'q_1_4'"),
    ("('opt_3', 'q_1_4'", "('opt_1_4_3', 'q_1_4'"),
    ("('opt_4', 'q_1_4'", "('opt_1_4_4', 'q_1_4'"),
    
    # Quiz 2.1
    ("('opt_1', 'q_2_1'", "('opt_2_1_1', 'q_2_1'"),
    ("('opt_2', 'q_2_1'", "('opt_2_1_2', 'q_2_1'"),
    ("('opt_3', 'q_2_1'", "('opt_2_1_3', 'q_2_1'"),
    
    # Quiz 2.2
    ("('opt_1', 'q_2_2'", "('opt_2_2_1', 'q_2_2'"),
    ("('opt_2', 'q_2_2'", "('opt_2_2_2', 'q_2_2'"),
    ("('opt_3', 'q_2_2'", "('opt_2_2_3', 'q_2_2'"),
    
    # Quiz 2.3
    ("('opt_1', 'q_2_3'", "('opt_2_3_1', 'q_2_3'"),
    ("('opt_2', 'q_2_3'", "('opt_2_3_2', 'q_2_3'"),
    ("('opt_3', 'q_2_3'", "('opt_2_3_3', 'q_2_3'"),
    
    # Quiz 2.4
    ("('opt_1', 'q_2_4'", "('opt_2_4_1', 'q_2_4'"),
    ("('opt_2', 'q_2_4'", "('opt_2_4_2', 'q_2_4'"),
    ("('opt_3', 'q_2_4'", "('opt_2_4_3', 'q_2_4'"),
    
    # Quiz 2.5
    ("('opt_1', 'q_2_5'", "('opt_2_5_1', 'q_2_5'"),
    ("('opt_2', 'q_2_5'", "('opt_2_5_2', 'q_2_5'"),
    ("('opt_3', 'q_2_5'", "('opt_2_5_3', 'q_2_5'"),
    
    # Quiz 3.1
    ("('opt_1', 'q_3_1'", "('opt_3_1_1', 'q_3_1'"),
    ("('opt_2', 'q_3_1'", "('opt_3_1_2', 'q_3_1'"),
    ("('opt_3', 'q_3_1'", "('opt_3_1_3', 'q_3_1'"),
    
    # Quiz 3.2
    ("('opt_1', 'q_3_2'", "('opt_3_2_1', 'q_3_2'"),
    ("('opt_2', 'q_3_2'", "('opt_3_2_2', 'q_3_2'"),
    ("('opt_3', 'q_3_2'", "('opt_3_2_3', 'q_3_2'"),
    
    # Quiz 3.3
    ("('opt_1', 'q_3_3'", "('opt_3_3_1', 'q_3_3'"),
    ("('opt_2', 'q_3_3'", "('opt_3_3_2', 'q_3_3'"),
    ("('opt_3', 'q_3_3'", "('opt_3_3_3', 'q_3_3'"),
    
    # Quiz 4.1
    ("('opt_1', 'q_4_1'", "('opt_4_1_1', 'q_4_1'"),
    ("('opt_2', 'q_4_1'", "('opt_4_1_2', 'q_4_1'"),
    ("('opt_3', 'q_4_1'", "('opt_4_1_3', 'q_4_1'"),
    
    # Quiz 4.2
    ("('opt_1', 'q_4_2'", "('opt_4_2_1', 'q_4_2'"),
    ("('opt_2', 'q_4_2'", "('opt_4_2_2', 'q_4_2'"),
    ("('opt_3', 'q_4_2'", "('opt_4_2_3', 'q_4_2'"),
    
    # Quiz 4.3
    ("('opt_1', 'q_4_3'", "('opt_4_3_1', 'q_4_3'"),
    ("('opt_2', 'q_4_3'", "('opt_4_3_2', 'q_4_3'"),
    ("('opt_3', 'q_4_3'", "('opt_4_3_3', 'q_4_3'"),
    
    # Quiz 4.4
    ("('opt_1', 'q_4_4'", "('opt_4_4_1', 'q_4_4'"),
    ("('opt_2', 'q_4_4'", "('opt_4_4_2', 'q_4_4'"),
    ("('opt_3', 'q_4_4'", "('opt_4_4_3', 'q_4_4'"),
    
    # Quiz 4.5
    ("('opt_1', 'q_4_5'", "('opt_4_5_1', 'q_4_5'"),
    ("('opt_2', 'q_4_5'", "('opt_4_5_2', 'q_4_5'"),
    ("('opt_3', 'q_4_5'", "('opt_4_5_3', 'q_4_5'"),
    
    # Quiz 4.6
    ("('opt_1', 'q_4_6'", "('opt_4_6_1', 'q_4_6'"),
    ("('opt_2', 'q_4_6'", "('opt_4_6_2', 'q_4_6'"),
    ("('opt_3', 'q_4_6'", "('opt_4_6_3', 'q_4_6'"),
    
    # Quiz 4.7
    ("('opt_1', 'q_4_7'", "('opt_4_7_1', 'q_4_7'"),
    ("('opt_2', 'q_4_7'", "('opt_4_7_2', 'q_4_7'"),
    ("('opt_3', 'q_4_7'", "('opt_4_7_3', 'q_4_7'"),
    
    # Quiz 5.1
    ("('opt_1', 'q_5_1'", "('opt_5_1_1', 'q_5_1'"),
    ("('opt_2', 'q_5_1'", "('opt_5_1_2', 'q_5_1'"),
    ("('opt_3', 'q_5_1'", "('opt_5_1_3', 'q_5_1'"),
    
    # Quiz 6.1
    ("('opt_1', 'q_6_1'", "('opt_6_1_1', 'q_6_1'"),
    ("('opt_2', 'q_6_1'", "('opt_6_1_2', 'q_6_1'"),
    ("('opt_3', 'q_6_1'", "('opt_6_1_3', 'q_6_1'"),
]

for old, new in replacements:
    content = content.replace(old, new)

with open('populate_course_data.sql', 'w') as f:
    f.write(content)

print("✅ IDs corrigidos com sucesso!")
print("Execute novamente o script SQL no Supabase.")
